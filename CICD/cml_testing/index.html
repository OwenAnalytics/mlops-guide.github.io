
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MLOps Guide introducing concepts and application using DVC, CML, IBM Watson Machine Learning, IBM Watson OpenScale, Terraform and Cookiecutter. Learn how to implement MLOps.">
      
      
      
        <meta name="author" content="Arthur Olga, Gabriel Monteiro, Guilherme Leite, Vinicius Lima">
      
      
        <link rel="canonical" href="https://mlops-guide.github.io/CICD/cml_testing/">
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.9">
    
    
      
        <title>Continuous Integration with CML and Github Actions - MLOps Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../ASCII_cinema/asciinema-player.css">
    
      <link rel="stylesheet" href="../../_css/extra_css.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="orange">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#continuous-integration-with-cml-and-github-actions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MLOps Guide" class="md-header__button md-logo" aria-label="MLOps Guide" data-md-component="logo">
      
  <img src="../../assets/logo-white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MLOps Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Continuous Integration with CML and Github Actions
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M9.598 1.591a.75.75 0 0 1 .785-.175 7 7 0 1 1-8.967 8.967.75.75 0 0 1 .961-.96 5.5 5.5 0 0 0 7.046-7.046.75.75 0 0 1 .175-.786zm1.616 1.945a7 7 0 0 1-7.678 7.678 5.5 5.5 0 1 0 7.678-7.678z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 10.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0zm0 13a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 8 13zM2.343 2.343a.75.75 0 0 1 1.061 0l1.06 1.061a.75.75 0 0 1-1.06 1.06l-1.06-1.06a.75.75 0 0 1 0-1.06zm9.193 9.193a.75.75 0 0 1 1.06 0l1.061 1.06a.75.75 0 0 1-1.06 1.061l-1.061-1.06a.75.75 0 0 1 0-1.061zM16 8a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 16 8zM3 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 3 8zm10.657-5.657a.75.75 0 0 1 0 1.061l-1.061 1.06a.75.75 0 1 1-1.06-1.06l1.06-1.06a.75.75 0 0 1 1.06 0zm-9.193 9.193a.75.75 0 0 1 0 1.06l-1.06 1.061a.75.75 0 1 1-1.061-1.06l1.06-1.061a.75.75 0 0 1 1.061 0z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/mlops-guide/mlops-guide.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    mlops-guide
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MLOps Guide" class="md-nav__button md-logo" aria-label="MLOps Guide" data-md-component="logo">
      
  <img src="../../assets/logo-white.png" alt="logo">

    </a>
    MLOps Guide
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/mlops-guide/mlops-guide.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    mlops-guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        Contents
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Principles of MLOps
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Principles of MLOps" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Principles of MLOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../MLOps/Data/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../MLOps/PipelineAutomation/" class="md-nav__link">
        Automation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../MLOps/FeatureStore/" class="md-nav__link">
        Feature Storing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../MLOps/CICDML/" class="md-nav__link">
        CI/CD for Machine Learning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../MLOps/Monitoring/" class="md-nav__link">
        Continuous Monitoring
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Implementation Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Implementation Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Implementation Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      <label class="md-nav__link" for="__nav_4_1">
        Introduction
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Introduction" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Structure/project_structure/" class="md-nav__link">
        Tools and Project Structure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Structure/starting/" class="md-nav__link">
        Starting a New Project with Cookiecutter
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      <label class="md-nav__link" for="__nav_4_2">
        Environment
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Environment" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Environment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Infraestrutura/Auth/" class="md-nav__link">
        IAM Access
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Infraestrutura/Terraform/" class="md-nav__link">
        Setting Up the IBM Environment with Terraform
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Infraestrutura/Python/" class="md-nav__link">
        Managing the deployment space
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      <label class="md-nav__link" for="__nav_4_3">
        Versioning
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Versioning" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Versioning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Versionamento/" class="md-nav__link">
        What is DVC?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Versionamento/basic_dvc/" class="md-nav__link">
        Data Versioning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Versionamento/pipelines_dvc/" class="md-nav__link">
        Working with Pipelines
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/" class="md-nav__link">
        Deployment with Watson Machine Learning
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" checked>
      
      <label class="md-nav__link" for="__nav_4_5">
        CI/CD for Machine Learning
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="CI/CD for Machine Learning" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          CI/CD for Machine Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tests/" class="md-nav__link">
        Implementing Tests
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Continuous Integration with CML and Github Actions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Continuous Integration with CML and Github Actions
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-cml" class="md-nav__link">
    What is CML?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-with-github-actions" class="md-nav__link">
    Testing With Github Actions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-test" class="md-nav__link">
    Pipeline Test
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-credentials" class="md-nav__link">
    Configuring Credentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-train-and-evaluate-workflow" class="md-nav__link">
    Adding Train and Evaluate Workflow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cml_deploy/" class="md-nav__link">
        Continous Delivery with CML, Github Actions and Watson ML
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Openscale/" class="md-nav__link">
        Monitoring with IBM OpenScale
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Workflow/" class="md-nav__link">
        Project Workflow
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-cml" class="md-nav__link">
    What is CML?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-with-github-actions" class="md-nav__link">
    Testing With Github Actions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-test" class="md-nav__link">
    Pipeline Test
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-credentials" class="md-nav__link">
    Configuring Credentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-train-and-evaluate-workflow" class="md-nav__link">
    Adding Train and Evaluate Workflow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/mlops-guide/mlops-guide.github.io/tree/main/docs/CICD/cml_testing.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="continuous-integration-with-cml-and-github-actions">Continuous Integration with CML and Github Actions</h1>
<h2 id="what-is-cml">What is CML?</h2>
<p>CML, which stands by Continuous Machine Learning, it's an open-source library focused on delivering CI/CD for machine learning projects. Its principles includes:
 GitFlow: Using Git workflow for managing experiments alongside DVC versioning data and models.
Auto reports for experiments: CML can generate reports in pull requests with metrics and plots helping the team to make informed and data-driven decisions
Technology Agnostics: Build pipelines with Github or Gitlab and run experiments with any cloud service.
Since we are using Github as our Git repository, Github Actions will be used to set up CML. Github Actions is managed by Github, so there is no need to worry about scale and operate the infrastructure just as other tools like Jenkins.</p>
<h2 id="testing-with-github-actions">Testing With Github Actions</h2>
<p>First, we will make sure our tests created at the <a href="/CICD/tests/">Testing with Pytest and Black</a> section are being executed every time that there is a new <em>push</em> to the repository on Github. This important in order to achieve redundancy in testing the project, and avoid making sure the code runs without errors on any environment and not just the developer's computer.</p>
<p>To do this is very simple. If you used cookiecutter you should already have a file named <strong>test_on_push.yaml</strong> at <code>.github/workflows/</code> folder. The content of the file should be:</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Python Package and Test</span>

    <span class="l l-Scalar l-Scalar-Plain">on</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">]</span>

    <span class="nt">jobs</span><span class="p">:</span>
        <span class="nt">build</span><span class="p">:</span>

        <span class="nt">runs-on</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
        <span class="nt">strategy</span><span class="p">:</span>
        <span class="nt">matrix</span><span class="p">:</span>
            <span class="nt">python-version</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">3.6</span><span class="p p-Indicator">]</span>

        <span class="nt">steps</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">uses</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">actions/checkout@v2</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Set up Python ${{ matrix.python-version }}</span>
        <span class="nt">uses</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v2</span>
        <span class="nt">with</span><span class="p">:</span>
        <span class="nt">python-version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ matrix.python-version }}</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
        <span class="nt">run</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="l l-Scalar l-Scalar-Plain">python -m pip install --upgrade pip</span>
        <span class="l l-Scalar l-Scalar-Plain">pip install pytest black</span>
        <span class="l l-Scalar l-Scalar-Plain">if [ -f requirements.txt ]; then pip install -r requirements.txt; fi</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Test with pytest</span>
        <span class="nt">run</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="l l-Scalar l-Scalar-Plain">pytest</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Python Black</span>
        <span class="nt">run</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="l l-Scalar l-Scalar-Plain">black . --check</span>
</code></pre></div>
<p>Now, we should take a look into those commands.</p>
<p><strong><em>Choosing when this action will run</em></strong>
<div class="highlight"><pre><span></span><code><span class="nt">on</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">]</span>
</code></pre></div>
Makes it run every time there is a push on the repository</p>
<p><strong><em>Setting up a Github Instance to run it</em></strong>
<div class="highlight"><pre><span></span><code><span class="nt">runs-on</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</code></pre></div>
Github will setup a free Ubuntu instance for us, using the latest official release.</p>
<p><strong><em>Chosing the right version of Python</em></strong>
<div class="highlight"><pre><span></span><code><span class="nt">matrix</span><span class="p">:</span>
    <span class="nt">python-version</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">3.6</span><span class="p p-Indicator">]</span>
</code></pre></div></p>
<p><strong><em>Installing test requirements</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">python -m pip install --upgrade pip</span>
<span class="l l-Scalar l-Scalar-Plain">pip install pytest black</span>
</code></pre></div></p>
<p><strong><em>Installing project requirements</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">if [ -f requirements.txt ]; then pip install -r requirements.txt; fi</span>
</code></pre></div></p>
<p><strong><em>Running Pytest</em></strong>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Test with pytest</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
    <span class="no">pytest</span>
</code></pre></div></p>
<p><strong><em>Running Black check</em></strong>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Python Black</span>
     <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
     <span class="no">black . --check</span>
</code></pre></div>
This checks that every Python file is formatted according to Black.</p>
<p>If all tests pass the commit pushed to the repository will receive a green check show it has no errors. </p>
<p><img alt="green check" src="../../assets/CICD/green_check.png" /></p>
<h2 id="pipeline-test">Pipeline Test</h2>
<p>After setting up our test on push, let's focus on reproducing our pipeline on push and generate an automated report in pull requests to compare the experiment with the model at the main branch.</p>
<h3 id="configuring-credentials">Configuring Credentials</h3>
<p>To reproduce our experiment pipeline, we need to start pulling our data versioned by DVC. On the other hand, Github Actions will execute our pipeline inside a container pre-configured by CML that doesn't have our IBM credentials to pull the data from IBM COS. So, to solve this, let's configure our IBM credentials in Github Secrets.</p>
<p>Github Secrets is a repository tool that encrypts credentials to be used as environment variables in the project.</p>
<ul>
<li>Go to the repository settings</li>
</ul>
<p><img alt="repo bar" src="../../assets/gitsecrets/repo_bar.png" /></p>
<ul>
<li>On the left menu, click on 'Secrets'</li>
</ul>
<p><img alt="repo settings menu" src="../../assets/gitsecrets/repo_settings_menu.png" /></p>
<ul>
<li>Click on 'New repository secret'</li>
</ul>
<p><img alt="repo add cred" src="../../assets/gitsecrets/repo_add_cred.png" /></p>
<ul>
<li>Add both <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code></li>
</ul>
<p><img alt="repo adding cred" src="../../assets/gitsecrets/repo_adding_cred.png" /></p>
<h3 id="adding-train-and-evaluate-workflow">Adding Train and Evaluate Workflow</h3>
<p>Just like we did at the <em>Testing Setup</em>, let's create a file named <strong>train_evaluate.yaml</strong> at the <code>.github/workflows/</code> folder, which content should be:</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">model-training-evaluate</span>
    <span class="l l-Scalar l-Scalar-Plain">on</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">]</span>
    <span class="nt">jobs</span><span class="p">:</span>
     <span class="nt">run</span><span class="p">:</span>
     <span class="nt">runs-on</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">ubuntu-latest</span><span class="p p-Indicator">]</span>
     <span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker://dvcorg/cml-py3:latest</span>
     <span class="nt">steps</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">uses</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">actions/checkout@v2</span>
     <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&#39;Train</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Evaluate</span><span class="nv"> </span><span class="s">model&#39;</span>
     <span class="nt">shell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bash</span>
     <span class="nt">env</span><span class="p">:</span>
     <span class="nt">repo_token</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
     <span class="nt">AWS_ACCESS_KEY_ID</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ secrets.AWS_ACCESS_KEY_ID }}</span>
     <span class="nt">AWS_SECRET_ACCESS_KEY</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ secrets.AWS_SECRET_ACCESS_KEY }}</span>
     <span class="nt">run</span><span class="p">:</span> <span class="p p-Indicator">|</span>
     <span class="c1"># Install requirements</span>
     <span class="l l-Scalar l-Scalar-Plain">pip install -r requirements.txt</span>

     <span class="c1"># Pull data &amp; run-cache from IBM COS and reproduce pipeline</span>
     <span class="l l-Scalar l-Scalar-Plain">dvc pull --run-cache</span>
     <span class="l l-Scalar l-Scalar-Plain">dvc repro</span>

     <span class="c1"># Report metrics</span>
     <span class="l l-Scalar l-Scalar-Plain">echo &quot;## Metrics&quot; &gt;&gt; report.md</span>
     <span class="l l-Scalar l-Scalar-Plain">git fetch --prune</span>
     <span class="l l-Scalar l-Scalar-Plain">dvc metrics diff master --show-md &gt;&gt; report.md</span>

     <span class="c1"># Publish ROC Curve and </span>
     <span class="l l-Scalar l-Scalar-Plain">echo -e &quot;## Plots\n### ROC Curve&quot; &gt;&gt; report.md</span>
     <span class="l l-Scalar l-Scalar-Plain">cml-publish ./results/roc_curve.png --md &gt;&gt; report.md</span>
     <span class="l l-Scalar l-Scalar-Plain">echo -e &quot;\n### Precision and Recall Curve&quot; &gt;&gt; report.md</span>
     <span class="l l-Scalar l-Scalar-Plain">cml-publish ./results/precision_recall_curve.png --md &gt;&gt; report.md</span>
     <span class="l l-Scalar l-Scalar-Plain">cml-send-comment report.md</span>
</code></pre></div>
<p>Let's dig into each command:</p>
<p><strong><em>Setting up a CML pre-configured container</em></strong>
<div class="highlight"><pre><span></span><code><span class="nt">container</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker://dvcorg/cml-py3:latest</span>
</code></pre></div></p>
<p><strong><em>Setting up environment credentials for IBM COS</em></strong>
<div class="highlight"><pre><span></span><code><span class="nt">env</span><span class="p">:</span> <span class="nt">repo_token</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span> 
<span class="nt">AWS_ACCESS_KEY_ID</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ secrets.AWS_ACCESS_KEY_ID }}</span>
<span class="nt">AWS_SECRET_ACCESS_KEY</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${{ secrets.AWS_SECRET_ACCESS_KEY}}</span>
</code></pre></div></p>
<p><strong><em>Installing requirements</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">pip install -r requirements.txt</span>
</code></pre></div></p>
<p><strong><em>Pull the versioned data and reproduce the full pipeline of training and evaluation</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">dvc pull --run-cache</span>
<span class="l l-Scalar l-Scalar-Plain">dvc repro</span>
</code></pre></div></p>
<p><strong><em>Formatting report section tittles</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">echo &quot;## Metrics&quot; &gt;&gt; report.md</span>
<span class="l l-Scalar l-Scalar-Plain">echo -e &quot;## Plots\n### ROC Curve&quot; &gt;&gt; report.md</span>
<span class="l l-Scalar l-Scalar-Plain">echo -e &quot;\n### Precision and Recall Curve&quot; &gt;&gt; report.md</span>
</code></pre></div></p>
<p><strong><em>Comparing metrics and publishing it to the report</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">dvc metrics diff master --show-md &gt;&gt; report.md</span>
</code></pre></div></p>
<p><strong><em>Publishing figures from the experiment to the report</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">cml-publish ./results/roc_curve.png --md &gt;&gt; report.md</span>
<span class="l l-Scalar l-Scalar-Plain">cml-publish ./results/precision_recall_curve.png --md &gt;&gt; report.md</span>
</code></pre></div></p>
<p><strong><em>Return the final report formatted as a comment on the Commit or Pull Request</em></strong>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">cml-send-comment report.md</span>
</code></pre></div></p>
<p>The Report should look like the following:
<img alt="report" src="../../assets/CICD/Capture.PNG" />(.zoom)</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../tests/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Implementing Tests" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Implementing Tests
            </div>
          </div>
        </a>
      
      
        
        <a href="../cml_deploy/" class="md-footer__link md-footer__link--next" aria-label="Next: Continous Delivery with CML, Github Actions and Watson ML" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Continous Delivery with CML, Github Actions and Watson ML
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.extend"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.82b56eb2.min.js"></script>
      
        <script src="../../ASCII_cinema/asciinema-player.js"></script>
      
        <script src="../../_js/extra_js.js"></script>
      
    
  </body>
</html>